<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Edit FEMA Nodes</title>
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f0f0; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; flex-direction: column; }
    h1 { color: #333; }
    #edit-container { width: 80%; max-width: 900px; text-align: center; }
    #editor-container { height: 400px; background-color: white; font-size: 1.2em; text-align: left; }
    #button-container { margin-top: 20px; display: flex; justify-content: center; gap: 20px; }
    .action-btn { padding: 15px 30px; font-size: 1.2em; border: none; border-radius: 8px; cursor: pointer; color: white; }
    #save-btn { background-color: #28a745; }
    #clear-btn { background-color: #dc3545; }
</style>
</head>
<body>

<h1>Edit FEMA Nodes</h1>
<div id="edit-container">
    <div id="editor-container"></div>
    <div id="button-container">
        <button id="save-btn" class="action-btn">Save and Go Back</button>
        <button id="clear-btn" class="action-btn">Clear Content</button>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
<script>
    // --- YOUR NEW "FEMA NODES" FIREBASE CONFIG ---
    const firebaseConfig = {
      apiKey: "AIzaSyChqasiD8LXTIktBt7uxxwD3WyUd4k8How",
      authDomain: "sad-cub-fema-nodes.firebaseapp.com",
      databaseURL: "https://sad-cub-fema-nodes-default-rtdb.firebaseio.com",
      projectId: "sad-cub-fema-nodes",
      storageBucket: "sad-cub-fema-nodes.appspot.com",
      messagingSenderId: "492482910097",
      appId: "1:492482910097:web:e970fcd951a09ad1a1ac30",
      measurementId: "G-NMHPGVMGMM"
    };

    if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
    }
    const database = firebase.database();

    document.addEventListener('DOMContentLoaded', function() {
        const saveBtn = document.getElementById('save-btn');
        const clearBtn = document.getElementById('clear-btn');
        const contentRef = database.ref('content');

        const quill = new Quill('#editor-container', {
            theme: 'snow',
            modules: {
                toolbar: [
                    [{ 'header': [1, 2, 3, false] }], ['bold', 'italic', 'underline'],
                    [{ 'list': 'ordered'}, { 'list': 'bullet' }], [{ 'align': [] }],
                    [{ 'color': [] }, { 'background': [] }], ['clean']
                ]
            }
        });

        contentRef.once('value', (snapshot) => {
            const currentContent = snapshot.val();
            if (currentContent) { quill.root.innerHTML = currentContent; }
        });

        saveBtn.addEventListener('click', function() {
            const newContent = quill.root.innerHTML;
            if (newContent === '<p><br></p>') {
                contentRef.remove();
                window.location.href = 'fema-nodes.html';
                return;
            }
            contentRef.set(newContent).then(() => { window.location.href = 'fema-nodes.html'; });
        });

        clearBtn.addEventListener('click', function() {
            if (confirm("Are you sure?")) {
                contentRef.remove().then(() => { quill.setText(''); });
            }
        });
    });
</script>
</body>
</html>
